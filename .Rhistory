mydata <- read.csv("SBA_Loan_data.csv")
setwd("Desktop/Stanford/Senior/Winter/MS&E246/ms-e246/")
getwd()
mydata <- read.csv("SBA_Loan_data.csv")
mydata$defaulted <- mydata$GrossChargeOffAmount > 0
set.seed(1000)
test_indices <- sample(147423,1000)
test_X <- mydata[test_indices,]
lm.fit <- lm(test_X$GrossChargeOffAmount~., data = test_X)
# Multiple Linear Regression Example
#fit <- lm(defaulted ~ ., data=mydata)
summary(lm.fit) # show results
lm.fit <- lm(GrossChargeOffAmount~., data = test_X)
summary(lm.fit) # show results
View(test_X)
View(test_indices)
View(mydata)
View(mydata)
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
summary(lm.fit) # show results
test_indices <- sample(147423,10000)
test_X <- mydata[test_indices,]
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ChargeOffDate")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate","defaulted")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate","defaulted","NaicsDescription")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate","defaulted","NaicsDescription","BorrState","CDC_State","ProjectState")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
pairs(test_X_pruned)
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate","defaulted","NaicsDescription","BorrState","CDC_State","ProjectState","LoanStatusCHGOFF","LoanStatusEXEMPT","LoanStatusPIF")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate","defaulted","NaicsDescription","BorrState","CDC_State","ProjectState","LoanStatus")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
pairs(test_X_pruned)
set.seed(1000)
test_indices <- sample(147423,50000)
test_X <- mydata[test_indices,]
#go through and take out states that aren't as relevant (calc # of defaults per state)
drops <- c("Program", "BorrName","BorrStreet","BorrCity","BorrZip","CDC_Name","CDC_Street","CDC_City","CDC_Zip","ThirdPartyLender_Name","ThirdPartyLender_City","ThirdPartyLender_State","ThirdPartyDollars","Delivery Method","ProjectCounty","ApprovalDate","ChargeOffDate","defaulted","NaicsDescription","BorrState","CDC_State","ProjectState","LoanStatus")
test_X_pruned <- test_X[,!(names(test_X) %in% drops)]
lm.fit <- lm(GrossChargeOffAmount~., data = test_X_pruned)
# Multiple Linear Regression Example
summary(lm.fit) # show results
pairs(test_X_pruned)
getwd()
